import os
import csv
import shutil

def разделить_текст_на_части(текст, количество_частей=1000):
    """
    Разделяет текст на заданное количество частей.

    Args:
        текст (str): Текст для разделения.
        количество_частей (int): Количество частей, на которые нужно разделить текст.

    Returns:
        list: Список частей текста.
    """
    длина_текста = len(текст)
    размер_части = длина_текста // количество_частей
    остаток = длина_текста % количество_частей
    части = []
    начало = 0
    for i in range(количество_частей):
        конец = начало + размер_части + (1 if i < остаток else 0)
        части.append(текст[начало:конец])
        начало = конец
    return части

def сохранить_части_в_csv(части, папка_назначения="Текстовые_части"):
    """
    Сохраняет части текста в отдельные CSV файлы в указанной папке.

    Args:
        части (list): Список частей текста.
        папка_назначения (str): Название папки, в которой будут сохранены файлы.
    """
    рабочий_стол = os.path.join(os.path.expanduser("~"), "Desktop")
    полный_путь = os.path.join(рабочий_стол, папка_назначения)

    # Создаем папку, если она не существует, и удаляем, если существует
    if os.path.exists(полный_путь):
        shutil.rmtree(полный_путь)
    os.makedirs(полный_путь)

    for i, часть in enumerate(части):
        имя_файла = os.path.join(полный_путь, f"часть_{i + 1}.csv")
        with open(имя_файла, 'w', newline='', encoding='utf-8') as csvfile:
            писатель = csv.writer(csvfile)
            писатель.writerow([часть])  # Запись текста в одну ячейку CSV

    print(f"Текст успешно разделен и сохранен в папке: {полный_путь}")

def разделить_адреса_и_сохранить(имя_файла_адресов, количество_частей=1000, папка_назначения="Адресные_части"):
    """
    Разделяет список адресов из CSV файла на части и сохраняет каждую часть в отдельный CSV файл.

    Args:
        имя_файла_адресов (str): Имя CSV файла, содержащего список адресов.
        количество_частей (int): Количество частей, на которые нужно разделить список адресов.
        папка_назначения (str): Название папки, в которой будут сохранены файлы.
    """
    адреса = []
    try:
        with open(имя_файла_адресов, 'r', newline='', encoding='utf-8') as csvfile:
            читатель = csv.reader(csvfile)
            for row in читатель:
                адреса.append(row[0])  # Предполагаем, что адреса в первом столбце
    except FileNotFoundError:
        print(f"Ошибка: Файл '{имя_файла_адресов}' не найден.")
        return

    части_адресов = [адреса[i::количество_частей] for i in range(количество_частей)]
    рабочий_стол = os.path.join(os.path.expanduser("~"), "Desktop")
    полный_путь = os.path.join(рабочий_стол, папка_назначения)

    if os.path.exists(полный_путь):
        shutil.rmtree(полный_путь)
    os.makedirs(полный_путь)

    for i, часть in enumerate(части_адресов):
        имя_файла = os.path.join(полный_путь, f"адреса_{i + 1}.csv")
        with open(имя_файла, 'w', newline='', encoding='utf-8') as csvfile:
            писатель = csv.writer(csvfile)
            for адрес in часть:
                писатель.writerow([адрес])

    print(f"Адреса успешно разделены и сохранены в папке: {полный_путь}")

# Пример использования
текст = input("Введите текст для разделения:\n")
части = разделить_текст_на_части(текст)
сохранить_части_в_csv(части)

# Разделение адресов из CSV файла
имя_файла_адресов = "адреса.csv"  # Укажите имя вашего CSV файла с адресами
разделить_адреса_и_сохранить(имя_файла_адресов)
